---
title: 分布式路由组网实践
date: 2021-02-19 13:41:48
tags: 工具 网络
---
# 40平米老房电力猫组网

## 背景

某新一线城市老小区，建筑面积40平方米，1989年建成，2018年左右经过某租房公司统一装修。带宽100Mbps。

![house 1](house1.png)

由于户型关系，路由器与卧室直线相隔一个卫生间，经过两面墙壁后卧室信号极差，连接速度<1Mbps频繁掉线。卧室门打开时，门口速度约为5-10Mbps。房屋仅有一处入户光纤，没有其他网线，无法使用基于网线的方案。若采用无线中继/桥接/mesh等，理论上在卧室进门处布置子路由有效，但是该处没有供电，无法使用。最终选用电力猫方案。

## 解决方案

选用tplink电力猫，一子一母。母路由wan口接入原路由器lan口，电力线接A点。子路由电力线接B点。理论上B点C点差异不大，但是因为不可知玄学因素，B点网速略快于C点。B、C两点均为一位五孔插座，由于tplink的电力猫体积较大，使用后会挡住整个插座面板，妨碍床头充电。因此又从C点拖了一块插线板，专供其他设备充电。

## 效果

实测网速可达40Mbps。

配对后子母电力猫使用同一个ssid，进出房间会自动切换。由于客厅和卧室信号强度相差极大，即使没有wifi漫游设备也能连接到正确的路由，因此无法判断漫游效果。连接母路由时，web后台显示无线连接，连接子路由时，web后台显示有线连接。

成本：315元（京东自营）

# 100平米新房有线mesh组网

## 背景

某县城新小区，建筑面积100平方米，2017年建成，2020年装修。带宽100Mbps。

![house 2](house2.png)

由于装修时提前规划，布置了大量网线。A处布置入户以及光猫。B\C\D\E\F1网线均有且仅有一根网线直通A，F2与F1相连。B\D两处为空调检修口，同时布有强电弱电，C\E两处有IPTV。设计时考虑使用B\D的空调检修口安装mesh路由器，但是这种方式维修极其不便。

由于屋内网络和A之间是星形连接，因此mesh路由器必须有一个结点在A，其他与A连接，被迫从两个结点增加到三个结点，且A处需要有三个wan/lan口。低价mesh路由器中，仅有tplink路由器有三个wan/lan口，且均价约160/结点。更便宜的水星、腾达等mesh路由器均价80/结点左右，但是只有两口。

## 解决方案

出于成本考虑，选择腾达mesh路由器3母+四口交换机方案。A处安装第一个结点，wan口连接光猫lan口，lan口连接交换机。交换机连接C\E\F网线。其余两个结点安装在C与F2，C处lan口连接iptv机顶盒。从全屋看F1的覆盖效果比F2好，但是由于F1面板高度按照电视机设计，因此选用F2。

## 效果

卧室1实测网速90Mbps，卧室2实测50Mbps，卫生间实测20Mbps，卧室3/书房实测50Mbps，客厅实测90Mbps。wifi无缝漫游。

成本：240(路由器)+40(交换机)

# 160平米较老房电力猫组网

## 背景

某县城老小区，建筑面积160平方米，07年左右装修。带宽12Mbps。房子过大，户型草图略。由于装修时间较早，笔者懒得查，布线情况不明。原网线接入西南角书房，因此东北角主卧wifi信号极差，而其他房间尚可。

房间墙插充足，故选用电力猫方案，但是考虑到面积较大，电器较多，且电力线使用时间较长，因此购买了tplink电力猫和华为q2s两套方案。tplink价格便宜，但是只有火线、零线两路，且只支持电力线组网。华为q2s价格较高，支持有线、无线和电力线混合组网，且电力线有火零地三线，组网质量更好，作为备用方案。

## 解决方案

将tplink电力猫的母路由wan口接原有路由器lan口，连接书房墙插。子路由连接东北角卧室墙插。

## 效果

电力猫配对时耗时较长，可能是电力线路的关系。但是配对成功后信号稳定，子路由跑满12Mbps。开启两个空调后，影响忽略不计。

由于tplink套装效果好，因此没有测试华为q2s方案。但是经提醒，装修时电工为农村电工，屋内地线不一定全部按规范接好，因此q2s的火零地三路加成可能不大。

成本：315（京东自营）